{% extends "trading/includes/header.html"  %}

{% block content %}
<div class="container-fluid">

    <h2 class="display-2 text-center">{{user.first_name}} Account</h2>

    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">

                    <ul class="nav nav-tabs card-header-tabs" id="bologna-list" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" href="#account" role="tab" aria-controls="account" aria-selected="true">Account</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#positions" role="tab" aria-controls="positions" aria-selected="false">Positions</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#favourites" role="tab" aria-controls="favourites" aria-selected="false">Favourites</a>
                        </li>
                    </ul>
                </div>

                <div class="card-body">
                    <h3 class="card-title">Your Account</h3>

                    <div class="tab-content mt-3">

                        <div class="tab-pane active" id="account" role="tabpanel">
                            <div class="card-text">
                                <ul class="list-group list-group-horizontal">

                                    <div class="list-group-item flex-fill">
                                        <h6>Account Details</h6>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item flex-fill"><h6>First Name:</h6><span>{{user.first_name}}</span></li>
                                            <li class="list-group-item flex-fill"><h6>Last Name:</h6> <span>{{user.last_name}}</span></li>
                                            <li class="list-group-item flex-fill"><h6>Email:</h6> <span>{{user.email}}</span></li>
                                            <li class="list-group-item flex-fill"><h6>Account Opened:</h6> <span>{{user.date_joined}}</span></li>
                                        </ul>
                                    </div>

                                </ul>
                            </div>
                        </div>

                        <div class="tab-pane" id="positions" role="tabpanel">
                            <div class="card-text">
                                <ul class="list-group list-group-horizontal">

                                    <div class="list-group-item flex-fill">
                                        <h6>Closed Positions</h6>
                                            {% if positions %}

                                            <table class="table">
                                                <thead>
                                                <tr>
                                                    <th scope="col">Position #</th>
                                                    <th scope="col">Open Date</th>
                                                    <th scope="col">Close Date</th>
                                                    <th scope="col">Instrument</th>
                                                    <th scope="col">Direction</th>
                                                    <th scope="col">Quantity</th>
                                                    <th scope="col">Open Price</th>
                                                    <th scope="col">Close Price</th>
                                                    <th scope="col">State</th>
                                                    <th scope="col">Result</th>
                                                </tr>
                                                </thead>
                                                <tbody>

                                                {% for position in positions %}
                                                <tr>
                                                    <th scope="row">{{position.position_number}}</th>
                                                    <td>{{position.open_date}}</td>
                                                    <td>{{position.close_date}}</td>
                                                    <td> <a href="{% url 'equity' position.ticker_id %}">{{position.ticker}}</a></td>
                                                    <td>{{position.direction}}</td>
                                                    <td>{{position.quantity}}</td>
                                                    <td>{{position.open_price}}</td>
                                                    <td>{{position.close_price}}</td>
                                                    <td>{{position.position_state}}</td>
                                                    <td>{{position.result}}</td>
                                                </tr>
                                                {% endfor %}
                                                </tbody>

                                            </table>

                                            {% else %}
                                            <span>No positions have been created on this account</span>
                                            {% endif %}
                                    </div>

                                </ul>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

{% endblock %}

